--- a/src/write.rs
+++ b/src/write.rs
@@ -1859,3 +1859,3 @@
 
-#[cfg(any(feature = "_deflate-any", feature = "bzip2", feature = "zstd"))]
+#[cfg(any(feature = "_deflate-any", feature = "bzip2", feature = "zstd", feature = "xz"))]
 fn clamp_opt<T: Ord + Copy, U: Ord + Copy + TryFrom<T>>(
