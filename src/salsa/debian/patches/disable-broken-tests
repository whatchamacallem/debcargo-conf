Index: salsa/Cargo.toml
===================================================================
--- salsa.orig/Cargo.toml
+++ salsa/Cargo.toml
@@ -39,397 +39,397 @@ salsa_unstable = []
 name = "salsa"
 path = "src/lib.rs"
 
-[[example]]
-name = "calc"
-path = "examples/calc/main.rs"
+#[[example]]
+#name = "calc"
+#path = "examples/calc/main.rs"
 
 #[[example]]
 #name = "lazy-input"
 #path = "examples/lazy-input/main.rs"
 
-[[test]]
-name = "accumulate"
-path = "tests/accumulate.rs"
+#[[test]]
+#name = "accumulate"
+#path = "tests/accumulate.rs"
 
-[[test]]
-name = "accumulate-chain"
-path = "tests/accumulate-chain.rs"
+#[[test]]
+#name = "accumulate-chain"
+#path = "tests/accumulate-chain.rs"
 
-[[test]]
-name = "accumulate-custom-debug"
-path = "tests/accumulate-custom-debug.rs"
+#[[test]]
+#name = "accumulate-custom-debug"
+#path = "tests/accumulate-custom-debug.rs"
 
-[[test]]
-name = "accumulate-dag"
-path = "tests/accumulate-dag.rs"
+#[[test]]
+#name = "accumulate-dag"
+#path = "tests/accumulate-dag.rs"
 
-[[test]]
-name = "accumulate-execution-order"
-path = "tests/accumulate-execution-order.rs"
+#[[test]]
+#name = "accumulate-execution-order"
+#path = "tests/accumulate-execution-order.rs"
 
-[[test]]
-name = "accumulate-from-tracked-fn"
-path = "tests/accumulate-from-tracked-fn.rs"
+#[[test]]
+#name = "accumulate-from-tracked-fn"
+#path = "tests/accumulate-from-tracked-fn.rs"
 
-[[test]]
-name = "accumulate-no-duplicates"
-path = "tests/accumulate-no-duplicates.rs"
+#[[test]]
+#name = "accumulate-no-duplicates"
+#path = "tests/accumulate-no-duplicates.rs"
 
-[[test]]
-name = "accumulate-reuse"
-path = "tests/accumulate-reuse.rs"
+#[[test]]
+#name = "accumulate-reuse"
+#path = "tests/accumulate-reuse.rs"
 
-[[test]]
-name = "accumulate-reuse-workaround"
-path = "tests/accumulate-reuse-workaround.rs"
+#[[test]]
+#name = "accumulate-reuse-workaround"
+#path = "tests/accumulate-reuse-workaround.rs"
 
-[[test]]
-name = "accumulated_backdate"
-path = "tests/accumulated_backdate.rs"
+#[[test]]
+#name = "accumulated_backdate"
+#path = "tests/accumulated_backdate.rs"
 
-[[test]]
-name = "backtrace"
-path = "tests/backtrace.rs"
+#[[test]]
+#name = "backtrace"
+#path = "tests/backtrace.rs"
 
-[[test]]
-name = "check_auto_traits"
-path = "tests/check_auto_traits.rs"
+#[[test]]
+#name = "check_auto_traits"
+#path = "tests/check_auto_traits.rs"
 
 #[[test]]
 #name = "compile_fail"
 #path = "tests/compile_fail.rs"
 
-[[test]]
-name = "cycle"
-path = "tests/cycle.rs"
+#[[test]]
+#name = "cycle"
+#path = "tests/cycle.rs"
 
-[[test]]
-name = "cycle_accumulate"
-path = "tests/cycle_accumulate.rs"
+#[[test]]
+#name = "cycle_accumulate"
+#path = "tests/cycle_accumulate.rs"
 
-[[test]]
-name = "cycle_fallback_immediate"
-path = "tests/cycle_fallback_immediate.rs"
+#[[test]]
+#name = "cycle_fallback_immediate"
+#path = "tests/cycle_fallback_immediate.rs"
 
-[[test]]
-name = "cycle_initial_call_back_into_cycle"
-path = "tests/cycle_initial_call_back_into_cycle.rs"
+#[[test]]
+#name = "cycle_initial_call_back_into_cycle"
+#path = "tests/cycle_initial_call_back_into_cycle.rs"
 
-[[test]]
-name = "cycle_initial_call_query"
-path = "tests/cycle_initial_call_query.rs"
+#[[test]]
+#name = "cycle_initial_call_query"
+#path = "tests/cycle_initial_call_query.rs"
 
-[[test]]
-name = "cycle_maybe_changed_after"
-path = "tests/cycle_maybe_changed_after.rs"
+#[[test]]
+#name = "cycle_maybe_changed_after"
+#path = "tests/cycle_maybe_changed_after.rs"
 
-[[test]]
-name = "cycle_output"
-path = "tests/cycle_output.rs"
+#[[test]]
+#name = "cycle_output"
+#path = "tests/cycle_output.rs"
 
-[[test]]
-name = "cycle_recovery_call_back_into_cycle"
-path = "tests/cycle_recovery_call_back_into_cycle.rs"
+#[[test]]
+#name = "cycle_recovery_call_back_into_cycle"
+#path = "tests/cycle_recovery_call_back_into_cycle.rs"
 
-[[test]]
-name = "cycle_recovery_call_query"
-path = "tests/cycle_recovery_call_query.rs"
+#[[test]]
+#name = "cycle_recovery_call_query"
+#path = "tests/cycle_recovery_call_query.rs"
 
-[[test]]
-name = "cycle_regression_455"
-path = "tests/cycle_regression_455.rs"
+#[[test]]
+#name = "cycle_regression_455"
+#path = "tests/cycle_regression_455.rs"
 
-[[test]]
-name = "cycle_result_dependencies"
-path = "tests/cycle_result_dependencies.rs"
+#[[test]]
+#name = "cycle_result_dependencies"
+#path = "tests/cycle_result_dependencies.rs"
 
-[[test]]
-name = "cycle_tracked"
-path = "tests/cycle_tracked.rs"
+#[[test]]
+#name = "cycle_tracked"
+#path = "tests/cycle_tracked.rs"
 
-[[test]]
-name = "cycle_tracked_own_input"
-path = "tests/cycle_tracked_own_input.rs"
+#[[test]]
+#name = "cycle_tracked_own_input"
+#path = "tests/cycle_tracked_own_input.rs"
 
-[[test]]
-name = "dataflow"
-path = "tests/dataflow.rs"
+#[[test]]
+#name = "dataflow"
+#path = "tests/dataflow.rs"
 
-[[test]]
-name = "debug"
-path = "tests/debug.rs"
+#[[test]]
+#name = "debug"
+#path = "tests/debug.rs"
 
-[[test]]
-name = "debug_db_contents"
-path = "tests/debug_db_contents.rs"
+#[[test]]
+#name = "debug_db_contents"
+#path = "tests/debug_db_contents.rs"
 
-[[test]]
-name = "deletion"
-path = "tests/deletion.rs"
+#[[test]]
+#name = "deletion"
+#path = "tests/deletion.rs"
 
-[[test]]
-name = "deletion-cascade"
-path = "tests/deletion-cascade.rs"
+#[[test]]
+#name = "deletion-cascade"
+#path = "tests/deletion-cascade.rs"
 
-[[test]]
-name = "deletion-drops"
-path = "tests/deletion-drops.rs"
+#[[test]]
+#name = "deletion-drops"
+#path = "tests/deletion-drops.rs"
 
 [[test]]
 name = "derive_update"
 path = "tests/derive_update.rs"
 
-[[test]]
-name = "durability"
-path = "tests/durability.rs"
+#[[test]]
+#name = "durability"
+#path = "tests/durability.rs"
 
-[[test]]
-name = "elided-lifetime-in-tracked-fn"
-path = "tests/elided-lifetime-in-tracked-fn.rs"
+#[[test]]
+#name = "elided-lifetime-in-tracked-fn"
+#path = "tests/elided-lifetime-in-tracked-fn.rs"
 
-[[test]]
-name = "expect_reuse_field_x_of_a_tracked_struct_changes_but_fn_depends_on_field_y"
-path = "tests/expect_reuse_field_x_of_a_tracked_struct_changes_but_fn_depends_on_field_y.rs"
+#[[test]]
+#name = "expect_reuse_field_x_of_a_tracked_struct_changes_but_fn_depends_on_field_y"
+#path = "tests/expect_reuse_field_x_of_a_tracked_struct_changes_but_fn_depends_on_field_y.rs"
 
-[[test]]
-name = "expect_reuse_field_x_of_an_input_changes_but_fn_depends_on_field_y"
-path = "tests/expect_reuse_field_x_of_an_input_changes_but_fn_depends_on_field_y.rs"
+#[[test]]
+#name = "expect_reuse_field_x_of_an_input_changes_but_fn_depends_on_field_y"
+#path = "tests/expect_reuse_field_x_of_an_input_changes_but_fn_depends_on_field_y.rs"
 
-[[test]]
-name = "hash_collision"
-path = "tests/hash_collision.rs"
+#[[test]]
+#name = "hash_collision"
+#path = "tests/hash_collision.rs"
 
-[[test]]
-name = "hello_world"
-path = "tests/hello_world.rs"
+#[[test]]
+#name = "hello_world"
+#path = "tests/hello_world.rs"
 
-[[test]]
-name = "input_default"
-path = "tests/input_default.rs"
+#[[test]]
+#name = "input_default"
+#path = "tests/input_default.rs"
 
-[[test]]
-name = "input_field_durability"
-path = "tests/input_field_durability.rs"
+#[[test]]
+#name = "input_field_durability"
+#path = "tests/input_field_durability.rs"
 
-[[test]]
-name = "input_setter_preserves_durability"
-path = "tests/input_setter_preserves_durability.rs"
+#[[test]]
+#name = "input_setter_preserves_durability"
+#path = "tests/input_setter_preserves_durability.rs"
 
-[[test]]
-name = "intern_access_in_different_revision"
-path = "tests/intern_access_in_different_revision.rs"
+#[[test]]
+#name = "intern_access_in_different_revision"
+#path = "tests/intern_access_in_different_revision.rs"
 
-[[test]]
-name = "interned-revisions"
-path = "tests/interned-revisions.rs"
+#[[test]]
+#name = "interned-revisions"
+#path = "tests/interned-revisions.rs"
 
-[[test]]
-name = "interned-structs"
-path = "tests/interned-structs.rs"
+#[[test]]
+#name = "interned-structs"
+#path = "tests/interned-structs.rs"
 
-[[test]]
-name = "interned-structs_self_ref"
-path = "tests/interned-structs_self_ref.rs"
+#[[test]]
+#name = "interned-structs_self_ref"
+#path = "tests/interned-structs_self_ref.rs"
 
-[[test]]
-name = "lru"
-path = "tests/lru.rs"
+#[[test]]
+#name = "lru"
+#path = "tests/lru.rs"
 
-[[test]]
-name = "memory-usage"
-path = "tests/memory-usage.rs"
+#[[test]]
+#name = "memory-usage"
+#path = "tests/memory-usage.rs"
 
-[[test]]
-name = "mutate_in_place"
-path = "tests/mutate_in_place.rs"
+#[[test]]
+#name = "mutate_in_place"
+#path = "tests/mutate_in_place.rs"
 
-[[test]]
-name = "override_new_get_set"
-path = "tests/override_new_get_set.rs"
+#[[test]]
+#name = "override_new_get_set"
+#path = "tests/override_new_get_set.rs"
 
-[[test]]
-name = "panic-when-creating-tracked-struct-outside-of-tracked-fn"
-path = "tests/panic-when-creating-tracked-struct-outside-of-tracked-fn.rs"
+#[[test]]
+#name = "panic-when-creating-tracked-struct-outside-of-tracked-fn"
+#path = "tests/panic-when-creating-tracked-struct-outside-of-tracked-fn.rs"
 
-[[test]]
-name = "parallel"
-path = "tests/parallel/main.rs"
+#[[test]]
+#name = "parallel"
+#path = "tests/parallel/main.rs"
 
-[[test]]
-name = "preverify-struct-with-leaked-data"
-path = "tests/preverify-struct-with-leaked-data.rs"
+#[[test]]
+#name = "preverify-struct-with-leaked-data"
+#path = "tests/preverify-struct-with-leaked-data.rs"
 
-[[test]]
-name = "preverify-struct-with-leaked-data-2"
-path = "tests/preverify-struct-with-leaked-data-2.rs"
+#[[test]]
+#name = "preverify-struct-with-leaked-data-2"
+#path = "tests/preverify-struct-with-leaked-data-2.rs"
 
-[[test]]
-name = "return_mode"
-path = "tests/return_mode.rs"
+#[[test]]
+#name = "return_mode"
+#path = "tests/return_mode.rs"
 
-[[test]]
-name = "singleton"
-path = "tests/singleton.rs"
+#[[test]]
+#name = "singleton"
+#path = "tests/singleton.rs"
 
-[[test]]
-name = "specify-only-works-if-the-key-is-created-in-the-current-query"
-path = "tests/specify-only-works-if-the-key-is-created-in-the-current-query.rs"
+#[[test]]
+#name = "specify-only-works-if-the-key-is-created-in-the-current-query"
+#path = "tests/specify-only-works-if-the-key-is-created-in-the-current-query.rs"
 
-[[test]]
-name = "synthetic_write"
-path = "tests/synthetic_write.rs"
+#[[test]]
+#name = "synthetic_write"
+#path = "tests/synthetic_write.rs"
 
-[[test]]
-name = "tracked-struct-id-field-bad-eq"
-path = "tests/tracked-struct-id-field-bad-eq.rs"
+#[[test]]
+#name = "tracked-struct-id-field-bad-eq"
+#path = "tests/tracked-struct-id-field-bad-eq.rs"
 
-[[test]]
-name = "tracked-struct-id-field-bad-hash"
-path = "tests/tracked-struct-id-field-bad-hash.rs"
+#[[test]]
+#name = "tracked-struct-id-field-bad-hash"
+#path = "tests/tracked-struct-id-field-bad-hash.rs"
 
-[[test]]
-name = "tracked-struct-unchanged-in-new-rev"
-path = "tests/tracked-struct-unchanged-in-new-rev.rs"
+#[[test]]
+#name = "tracked-struct-unchanged-in-new-rev"
+#path = "tests/tracked-struct-unchanged-in-new-rev.rs"
 
-[[test]]
-name = "tracked-struct-value-field-bad-eq"
-path = "tests/tracked-struct-value-field-bad-eq.rs"
+#[[test]]
+#name = "tracked-struct-value-field-bad-eq"
+#path = "tests/tracked-struct-value-field-bad-eq.rs"
 
-[[test]]
-name = "tracked-struct-value-field-not-eq"
-path = "tests/tracked-struct-value-field-not-eq.rs"
+#[[test]]
+#name = "tracked-struct-value-field-not-eq"
+#path = "tests/tracked-struct-value-field-not-eq.rs"
 
-[[test]]
-name = "tracked_assoc_fn"
-path = "tests/tracked_assoc_fn.rs"
+#[[test]]
+#name = "tracked_assoc_fn"
+#path = "tests/tracked_assoc_fn.rs"
 
-[[test]]
-name = "tracked_fn_constant"
-path = "tests/tracked_fn_constant.rs"
+#[[test]]
+#name = "tracked_fn_constant"
+#path = "tests/tracked_fn_constant.rs"
 
-[[test]]
-name = "tracked_fn_high_durability_dependency"
-path = "tests/tracked_fn_high_durability_dependency.rs"
+#[[test]]
+#name = "tracked_fn_high_durability_dependency"
+#path = "tests/tracked_fn_high_durability_dependency.rs"
 
-[[test]]
-name = "tracked_fn_interned_lifetime"
-path = "tests/tracked_fn_interned_lifetime.rs"
+#[[test]]
+#name = "tracked_fn_interned_lifetime"
+#path = "tests/tracked_fn_interned_lifetime.rs"
 
-[[test]]
-name = "tracked_fn_multiple_args"
-path = "tests/tracked_fn_multiple_args.rs"
+#[[test]]
+#name = "tracked_fn_multiple_args"
+#path = "tests/tracked_fn_multiple_args.rs"
 
-[[test]]
-name = "tracked_fn_no_eq"
-path = "tests/tracked_fn_no_eq.rs"
+#[[test]]
+#name = "tracked_fn_no_eq"
+#path = "tests/tracked_fn_no_eq.rs"
 
-[[test]]
-name = "tracked_fn_on_input"
-path = "tests/tracked_fn_on_input.rs"
+#[[test]]
+#name = "tracked_fn_on_input"
+#path = "tests/tracked_fn_on_input.rs"
 
-[[test]]
-name = "tracked_fn_on_input_with_high_durability"
-path = "tests/tracked_fn_on_input_with_high_durability.rs"
+#[[test]]
+#name = "tracked_fn_on_input_with_high_durability"
+#path = "tests/tracked_fn_on_input_with_high_durability.rs"
 
-[[test]]
-name = "tracked_fn_on_interned"
-path = "tests/tracked_fn_on_interned.rs"
+#[[test]]
+#name = "tracked_fn_on_interned"
+#path = "tests/tracked_fn_on_interned.rs"
 
-[[test]]
-name = "tracked_fn_on_interned_enum"
-path = "tests/tracked_fn_on_interned_enum.rs"
+#[[test]]
+#name = "tracked_fn_on_interned_enum"
+#path = "tests/tracked_fn_on_interned_enum.rs"
 
-[[test]]
-name = "tracked_fn_on_tracked"
-path = "tests/tracked_fn_on_tracked.rs"
+#[[test]]
+#name = "tracked_fn_on_tracked"
+#path = "tests/tracked_fn_on_tracked.rs"
 
-[[test]]
-name = "tracked_fn_on_tracked_specify"
-path = "tests/tracked_fn_on_tracked_specify.rs"
+#[[test]]
+#name = "tracked_fn_on_tracked_specify"
+#path = "tests/tracked_fn_on_tracked_specify.rs"
 
-[[test]]
-name = "tracked_fn_orphan_escape_hatch"
-path = "tests/tracked_fn_orphan_escape_hatch.rs"
+#[[test]]
+#name = "tracked_fn_orphan_escape_hatch"
+#path = "tests/tracked_fn_orphan_escape_hatch.rs"
 
-[[test]]
-name = "tracked_fn_read_own_entity"
-path = "tests/tracked_fn_read_own_entity.rs"
+#[[test]]
+#name = "tracked_fn_read_own_entity"
+#path = "tests/tracked_fn_read_own_entity.rs"
 
-[[test]]
-name = "tracked_fn_read_own_specify"
-path = "tests/tracked_fn_read_own_specify.rs"
+#[[test]]
+#name = "tracked_fn_read_own_specify"
+#path = "tests/tracked_fn_read_own_specify.rs"
 
-[[test]]
-name = "tracked_fn_return_ref"
-path = "tests/tracked_fn_return_ref.rs"
+#[[test]]
+#name = "tracked_fn_return_ref"
+#path = "tests/tracked_fn_return_ref.rs"
 
-[[test]]
-name = "tracked_method"
-path = "tests/tracked_method.rs"
+#[[test]]
+#name = "tracked_method"
+#path = "tests/tracked_method.rs"
 
-[[test]]
-name = "tracked_method_inherent_return_deref"
-path = "tests/tracked_method_inherent_return_deref.rs"
+#[[test]]
+#name = "tracked_method_inherent_return_deref"
+#path = "tests/tracked_method_inherent_return_deref.rs"
 
-[[test]]
-name = "tracked_method_inherent_return_ref"
-path = "tests/tracked_method_inherent_return_ref.rs"
+#[[test]]
+#name = "tracked_method_inherent_return_ref"
+#path = "tests/tracked_method_inherent_return_ref.rs"
 
-[[test]]
-name = "tracked_method_on_tracked_struct"
-path = "tests/tracked_method_on_tracked_struct.rs"
+#[[test]]
+#name = "tracked_method_on_tracked_struct"
+#path = "tests/tracked_method_on_tracked_struct.rs"
 
-[[test]]
-name = "tracked_method_trait_return_ref"
-path = "tests/tracked_method_trait_return_ref.rs"
+#[[test]]
+#name = "tracked_method_trait_return_ref"
+#path = "tests/tracked_method_trait_return_ref.rs"
 
-[[test]]
-name = "tracked_method_with_self_ty"
-path = "tests/tracked_method_with_self_ty.rs"
+#[[test]]
+#name = "tracked_method_with_self_ty"
+#path = "tests/tracked_method_with_self_ty.rs"
 
-[[test]]
-name = "tracked_struct"
-path = "tests/tracked_struct.rs"
+#[[test]]
+#name = "tracked_struct"
+#path = "tests/tracked_struct.rs"
 
-[[test]]
-name = "tracked_struct_db1_lt"
-path = "tests/tracked_struct_db1_lt.rs"
+#[[test]]
+#name = "tracked_struct_db1_lt"
+#path = "tests/tracked_struct_db1_lt.rs"
 
-[[test]]
-name = "tracked_struct_disambiguates"
-path = "tests/tracked_struct_disambiguates.rs"
+#[[test]]
+#name = "tracked_struct_disambiguates"
+#path = "tests/tracked_struct_disambiguates.rs"
 
-[[test]]
-name = "tracked_struct_durability"
-path = "tests/tracked_struct_durability.rs"
+#[[test]]
+#name = "tracked_struct_durability"
+#path = "tests/tracked_struct_durability.rs"
 
-[[test]]
-name = "tracked_struct_manual_update"
-path = "tests/tracked_struct_manual_update.rs"
+#[[test]]
+#name = "tracked_struct_manual_update"
+#path = "tests/tracked_struct_manual_update.rs"
 
-[[test]]
-name = "tracked_struct_mixed_tracked_fields"
-path = "tests/tracked_struct_mixed_tracked_fields.rs"
+#[[test]]
+#name = "tracked_struct_mixed_tracked_fields"
+#path = "tests/tracked_struct_mixed_tracked_fields.rs"
 
-[[test]]
-name = "tracked_struct_recreate_new_revision"
-path = "tests/tracked_struct_recreate_new_revision.rs"
+#[[test]]
+#name = "tracked_struct_recreate_new_revision"
+#path = "tests/tracked_struct_recreate_new_revision.rs"
 
-[[test]]
-name = "tracked_struct_with_interned_query"
-path = "tests/tracked_struct_with_interned_query.rs"
+#[[test]]
+#name = "tracked_struct_with_interned_query"
+#path = "tests/tracked_struct_with_interned_query.rs"
 
-[[test]]
-name = "tracked_with_intern"
-path = "tests/tracked_with_intern.rs"
+#[[test]]
+#name = "tracked_with_intern"
+#path = "tests/tracked_with_intern.rs"
 
-[[test]]
-name = "tracked_with_struct_db"
-path = "tests/tracked_with_struct_db.rs"
+#[[test]]
+#name = "tracked_with_struct_db"
+#path = "tests/tracked_with_struct_db.rs"
 
-[[test]]
-name = "tracked_with_struct_ord"
-path = "tests/tracked_with_struct_ord.rs"
+#[[test]]
+#name = "tracked_with_struct_ord"
+#path = "tests/tracked_with_struct_ord.rs"
 
 [[test]]
 name = "warnings"
Index: salsa/src/accumulator/accumulated_map.rs
===================================================================
--- salsa.orig/src/accumulator/accumulated_map.rs
+++ salsa/src/accumulator/accumulated_map.rs
@@ -138,7 +138,7 @@ impl AtomicInputAccumulatedValues {
 mod tests {
     use super::*;
 
-    #[test]
+    /*#[test]
     fn atomic_input_accumulated_values() {
         let val = AtomicInputAccumulatedValues::new(InputAccumulatedValues::Empty);
         assert_eq!(val.load(), InputAccumulatedValues::Empty);
@@ -148,5 +148,5 @@ mod tests {
         assert_eq!(val.load(), InputAccumulatedValues::Any);
         val.store(InputAccumulatedValues::Empty);
         assert_eq!(val.load(), InputAccumulatedValues::Empty);
-    }
+    }*/
 }
