# overrides: add custom test for linking against cdylib
# overrides: add env var to custom_prefix test
# overrides: reduce all-features test to test most features, since both allocators can't be enabled at the same time
# overrides: add c-allocator feature to gz test, since one allocator needs to be enabled
Tests: link-cdylib-example
Depends: gcc, pkgconf, libz-rs-dev
Restrictions: allow-stderr

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --features gz,gzprintf,semver-prefix
Features: test-name=rust-libz-rs-sys-cdylib:@-customized
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features __internal-test
Features: test-name=librust-libz-rs-sys-cdylib-dev:__internal-test
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features c-allocator
Features: test-name=librust-libz-rs-sys-cdylib-dev:c-allocator
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features capi
Features: test-name=librust-libz-rs-sys-cdylib-dev:capi
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: LIBZ_RS_SYS_PREFIX=LIBZ_RS_AUTOPKGTEST_ /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features custom-prefix
Features: test-name=librust-libz-rs-sys-cdylib-dev:custom-prefix
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets
Features: test-name=librust-libz-rs-sys-cdylib-dev:default
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features gz,c-allocator
Features: test-name=librust-libz-rs-sys-cdylib-dev:gz
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features gzprintf
Features: test-name=librust-libz-rs-sys-cdylib-dev:gzprintf
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features rust-allocator
Features: test-name=librust-libz-rs-sys-cdylib-dev:rust-allocator
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features --features semver-prefix
Features: test-name=librust-libz-rs-sys-cdylib-dev:semver-prefix
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable

Test-Command: /usr/share/cargo/bin/cargo-auto-test libz-rs-sys-cdylib 0.5.2 --all-targets --no-default-features
Features: test-name=librust-libz-rs-sys-cdylib-dev:
Depends: dh-cargo (>= 31), rustc (>= 1.75), @
Restrictions: allow-stderr, skip-not-installable
