implementation of rustls21::server::ClientCertVerifier for 
AllowAnyAnonymousOrCertificateBearingClient taken from 
https://github.com/pendulum-project/ntpd-rs/blob/49d6af53ec37cec30b7137a89535ca3d3143fbac/ntp-proto/src/tls_utils.rs

Index: ntp-proto/src/nts_record.rs
===================================================================
--- ntp-proto.orig/src/nts_record.rs
+++ ntp-proto/src/nts_record.rs
@@ -2957,12 +2957,14 @@ mod test {
             .with_client_cert_verifier(Arc::new(
                 #[cfg(not(feature = "nts-pool"))]
                 tls_utils::NoClientAuth,
-                #[cfg(feature = "nts-pool")]
+                #[cfg(all(feature = "nts-pool", feature = "rustls23"))]
                 crate::tls_utils::AllowAnyAnonymousOrCertificateBearingClient::new(
                     // We know that our previous call to ServerConfig::builder already
                     // installed a default provider, but this is undocumented
                     rustls23::crypto::CryptoProvider::get_default().unwrap(),
                 ),
+                #[cfg(all(feature = "nts-pool", not(feature = "rustls23")))]
+                crate::tls_utils::AllowAnyAnonymousOrCertificateBearingClient,
             ))
             .with_single_cert(cert_chain.clone(), key_der.clone_key().into())
             .unwrap();
Index: ntp-proto/Cargo.toml
===================================================================
--- ntp-proto.orig/Cargo.toml
+++ ntp-proto/Cargo.toml
@@ -75,6 +75,7 @@ optional = true
 version = "0.21.0"
 optional = true
 package = "rustls"
+features = ["dangerous_configuration"]
 
 [dependencies.rustls22]
 version = "0.22.0"
@@ -119,9 +120,9 @@ __internal-fuzz = [
     "__internal-api",
 ]
 __internal-test = ["__internal-api"]
-default = ["rustls23"]
+default = ["rustls21"]
 ntpv5 = []
-nts-pool = ["rustls23"]
+nts-pool = ["rustls21"]
 rustls21 = [
     "dep:rustls21",
     "dep:rustls-pemfile1",
Index: ntp-proto/src/nts_pool_ke.rs
===================================================================
--- ntp-proto.orig/src/nts_pool_ke.rs
+++ ntp-proto/src/nts_pool_ke.rs
@@ -89,7 +89,10 @@ pub struct ClientToPoolData {
 impl ClientToPoolData {
     pub fn extract_nts_keys<ConnectionData>(
         &self,
+        #[cfg(feature = "rustls23")]
         stream: &rustls23::ConnectionCommon<ConnectionData>,
+        #[cfg(not(feature = "rustls23"))]
+        stream: &rustls21::ConnectionCommon<ConnectionData>,
     ) -> Result<NtsKeys, KeyExchangeError> {
         self.algorithm
             .extract_nts_keys(self.protocol, stream)
Index: ntp-proto/src/tls_utils.rs
===================================================================
--- ntp-proto.orig/src/tls_utils.rs
+++ ntp-proto/src/tls_utils.rs
@@ -191,11 +191,33 @@ mod rustls21_shim {
     pub use rustls21::RootCertStore;
     pub use rustls21::ServerConfig;
     pub use rustls21::ServerConnection;
+    use rustls21::server::ClientCertVerified;
 
     #[cfg(feature = "nts-pool")]
     #[derive(Debug)]
     pub struct AllowAnyAnonymousOrCertificateBearingClient;
 
+    #[cfg(feature = "nts-pool")]
+    impl rustls21::server::ClientCertVerifier for AllowAnyAnonymousOrCertificateBearingClient {
+        fn client_auth_root_subjects(&self) -> &[rustls21::DistinguishedName] {
+            &[]
+        }
+
+        fn verify_client_cert(
+            &self,
+            _end_entity: &Certificate,
+            _intermediates: &[Certificate],
+            _now: std::time::SystemTime,
+        ) -> Result<ClientCertVerified, rustls21::Error> {
+            Ok(ClientCertVerified::assertion())
+        }
+
+        fn client_auth_mandatory(&self) -> bool {
+            false
+        }
+
+    }
+
     pub fn client_config_builder(
     ) -> rustls21::ConfigBuilder<rustls21::ClientConfig, rustls21::WantsVerifier> {
         ClientConfig::builder().with_safe_defaults()
