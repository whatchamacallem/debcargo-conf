From abea6478b0d77c2348dbdc4fedc69138868fd52b Mon Sep 17 00:00:00 2001
From: NoisyCoil <noisycoil@tutanota.com>
Date: Thu, 27 Mar 2025 02:04:23 +0100
Subject: [PATCH 2/2] Add sysusers.d configuration

Signed-off-by: NoisyCoil <noisycoil@tutanota.com>
---
 Makefile                     | 3 +++
 speakersafetyd.sysusers.conf | 2 ++
 2 files changed, 5 insertions(+)
 create mode 100644 speakersafetyd.sysusers.conf

diff --git a/Makefile b/Makefile
index 665cca1..2195b7a 100644
--- a/Makefile
+++ b/Makefile
@@ -4,6 +4,7 @@
 BINDIR ?= /usr/bin
 UNITDIR ?= /lib/systemd/system
 UDEVDIR ?= /lib/udev/rules.d
+SYSUSERSDIR ?= /usr/lib/sysusers.d
 TMPFILESDIR ?= /usr/lib/tmpfiles.d
 SHAREDIR ?= /usr/share/
 VARDIR ?= /var/
@@ -20,6 +21,8 @@ install: install-data
 install-data:
 	install -dDm0755 $(DESTDIR)/$(UNITDIR)
 	install -pm0644 speakersafetyd.service $(DESTDIR)/$(UNITDIR)/speakersafetyd.service
+	install -dDm0755 $(DESTDIR)/$(SYSUSERSDIR)
+	install -pm0644 speakersafetyd.sysusers.conf $(DESTDIR)/$(SYSUSERSDIR)/speakersafetyd.conf
 	install -dDm0755 $(DESTDIR)/$(UDEVDIR)
 	install -pm0644 95-speakersafetyd.rules $(DESTDIR)/$(UDEVDIR)/95-speakersafetyd.rules
 	install -dDm0755 $(DESTDIR)/$(SHAREDIR)/speakersafetyd/apple
diff --git a/speakersafetyd.sysusers.conf b/speakersafetyd.sysusers.conf
new file mode 100644
index 0000000..e09cccd
--- /dev/null
+++ b/speakersafetyd.sysusers.conf
@@ -0,0 +1,2 @@
+u    speakersafetyd    -        "Speakersafetyd daemon"    /var/lib/speakersafetyd    -
+m    speakersafetyd    audio
-- 
2.47.2

