diff --git a/src/lib.rs b/src/lib.rs
index f861136..7ebf457 100644
--- a/src/lib.rs
+++ b/src/lib.rs
@@ -138,6 +138,8 @@ macro_rules! custom_keyword {
 /// instead of keywords (`Token::Keyword`).
 ///
 /// ```
+/// #[cfg(feature = "wasm-module")]
+/// {
 /// use wast::parser::{Parser, Result, Parse};
 ///
 /// // Define a custom reserved symbol, the "spaceship" operator: `<=>`.
@@ -158,6 +160,7 @@ macro_rules! custom_keyword {
 ///         Ok(ThreeWayComparison { lhs, rhs })
 ///     }
 /// }
+/// }
 /// ```
 #[macro_export]
 macro_rules! custom_reserved {
diff --git a/src/parser.rs b/src/parser.rs
index 54305b2..60cb680 100644
--- a/src/parser.rs
+++ b/src/parser.rs
@@ -8,6 +8,8 @@
 //! The top-level [`parse`] function can be used to fully parse AST fragments:
 //!
 //! ```
+//! #[cfg(feature = "wasm-module")]
+//! {
 //! use wast::Wat;
 //! use wast::parser::{self, ParseBuffer};
 //!
@@ -17,11 +19,14 @@
 //! let module = parser::parse::<Wat>(&buf)?;
 //! # Ok(())
 //! # }
+//! }
 //! ```
 //!
 //! and you can also define your own new syntax with the [`Parse`] trait:
 //!
 //! ```
+//! #[cfg(feature = "wasm-module")]
+//! {
 //! use wast::kw;
 //! use wast::core::{Import, Func};
 //! use wast::parser::{Parser, Parse, Result};
@@ -57,6 +62,7 @@
 //!         Ok(OnlyImportsAndFunctions { imports, functions })
 //!     }
 //! }
+//! }
 //! ```
 //!
 //! This module is heavily inspired by [`syn`](https://docs.rs/syn) so you can
@@ -94,6 +100,8 @@ pub(crate) const MAX_PARENS_DEPTH: usize = 100;
 /// # Examples
 ///
 /// ```
+/// #[cfg(feature = "wasm-module")]
+/// {
 /// use wast::Wat;
 /// use wast::parser::{self, ParseBuffer};
 ///
@@ -103,6 +111,7 @@ pub(crate) const MAX_PARENS_DEPTH: usize = 100;
 /// let module = parser::parse::<Wat>(&buf)?;
 /// # Ok(())
 /// # }
+/// }
 /// ```
 ///
 /// or parsing simply a fragment
@@ -185,6 +194,8 @@ pub fn parse<'a, T: Parse<'a>>(buf: &'a ParseBuffer<'a>) -> Result<T> {
 /// before all functions. An example [`Parse`] implementation might look like:
 ///
 /// ```
+/// #[cfg(feature = "wasm-module")]
+/// {
 /// use wast::core::{Import, Func};
 /// use wast::kw;
 /// use wast::parser::{Parser, Parse, Result};
@@ -220,6 +231,7 @@ pub fn parse<'a, T: Parse<'a>>(buf: &'a ParseBuffer<'a>) -> Result<T> {
 ///         Ok(OnlyImportsAndFunctions { imports, functions })
 ///     }
 /// }
+/// }
 /// ```
 pub trait Parse<'a>: Sized {
     /// Attempts to parse `Self` from `parser`, returning an error if it could
@@ -538,6 +550,8 @@ impl<'a> Parser<'a> {
     /// and a [`RefType`]
     ///
     /// ```
+    /// #[cfg(feature = "wasm-module")]
+    /// {
     /// # use wast::core::*;
     /// # use wast::parser::*;
     /// struct TableType<'a> {
@@ -554,6 +568,7 @@ impl<'a> Parser<'a> {
     ///         })
     ///     }
     /// }
+    /// }
     /// ```
     ///
     /// [`Limits`]: crate::core::Limits
@@ -719,6 +734,8 @@ impl<'a> Parser<'a> {
     /// the exact definition, but it's close enough!
     ///
     /// ```
+    /// #[cfg(feature = "wasm-module")]
+    /// {
     /// # use wast::kw;
     /// # use wast::core::*;
     /// # use wast::parser::*;
@@ -740,6 +757,7 @@ impl<'a> Parser<'a> {
     ///         Ok(Module { fields })
     ///     }
     /// }
+    /// }
     /// ```
     pub fn parens<T>(self, f: impl FnOnce(Parser<'a>) -> Result<T>) -> Result<T> {
         self.buf.depth.set(self.buf.depth.get() + 1);
@@ -917,6 +935,8 @@ impl<'a> Parser<'a> {
     /// registered *before* we parse the parentheses of the annotation.
     ///
     /// ```
+    /// #[cfg(feature = "wasm-module")]
+    /// {
     /// # use wast::{kw, annotation};
     /// # use wast::core::Custom;
     /// # use wast::parser::*;
@@ -963,6 +983,7 @@ impl<'a> Parser<'a> {
     ///         Err(parser.error("unknown module field"))
     ///     }
     /// }
+    /// }
     /// ```
     ///
     /// [annotation]: https://github.com/WebAssembly/annotations
diff --git a/tests/comments.rs b/tests/comments.rs
index 54b649c..577e244 100644
--- a/tests/comments.rs
+++ b/tests/comments.rs
@@ -1,3 +1,4 @@
+#![cfg(feature = "wasm-module")]
 use wast::parser::{self, Parse, ParseBuffer, Parser, Result};
 
 pub struct Comments<'a> {
