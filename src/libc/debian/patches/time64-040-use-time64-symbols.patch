commit 3c3c01f9e5da55f8843e5d111a430bc75af4c600
Author: Ola x Nilsson <olani@axis.com>
Date:   Fri Mar 17 08:44:44 2023 +0100

    gnu: Use _TIME_BITS and _FILE_OFFSET_BITS=64 versions of glibc symbols
    
    Set the link names of relevant symbols to use be the same as when a C
    program is built against GNU libc with -D_TIME_BITS=64 and
    -D_FILE_OFFSET_BITS=64.

--- a/src/unix/linux_like/linux/gnu/b32/mod.rs
+++ b/src/unix/linux_like/linux/gnu/b32/mod.rs
@@ -340,2 +340,4 @@
     ) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__ntp_gettime64")]
+    pub fn ntp_gettime(buf: *mut ntptimeval) -> c_int;
 }
--- a/src/unix/linux_like/linux/gnu/b64/mod.rs
+++ b/src/unix/linux_like/linux/gnu/b64/mod.rs
@@ -103,2 +103,7 @@
 
+extern "C" {
+    #[link_name = "ntp_gettimex"]
+    pub fn ntp_gettime(buf: *mut crate::ntptimeval) -> c_int;
+}
+
 cfg_if! {
--- a/src/unix/linux_like/linux/gnu/mod.rs
+++ b/src/unix/linux_like/linux/gnu/mod.rs
@@ -1295,2 +1295,3 @@
     );
+    #[cfg_attr(gnu_time64_abi, link_name = "__sendmmsg64")]
     pub fn sendmmsg(
@@ -1301,2 +1302,3 @@
     ) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__recvmmsg64")]
     pub fn recvmmsg(
@@ -1312,4 +1314,7 @@
         -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "getrlimit64")]
     pub fn getrlimit(resource: crate::__rlimit_resource_t, rlim: *mut crate::rlimit) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "setrlimit64")]
     pub fn setrlimit(resource: crate::__rlimit_resource_t, rlim: *const crate::rlimit) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "prlimit64")]
     pub fn prlimit(
@@ -1336,2 +1341,3 @@
     pub fn mallopt(param: c_int, value: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__gettimeofday64")]
     pub fn gettimeofday(tp: *mut crate::timeval, tz: *mut crate::timezone) -> c_int;
@@ -1341,6 +1347,7 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "___adjtimex64")]
     pub fn adjtimex(buf: *mut timex) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "___adjtimex64")]
     pub fn ntp_adjtime(buf: *mut timex) -> c_int;
-    #[link_name = "ntp_gettimex"]
-    pub fn ntp_gettime(buf: *mut ntptimeval) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__clock_adjtime64")]
     pub fn clock_adjtime(clk_id: crate::clockid_t, buf: *mut crate::timex) -> c_int;
@@ -1354,2 +1361,3 @@
     ) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "preadv64v2")]
     pub fn preadv2(
@@ -1361,2 +1369,3 @@
     ) -> ssize_t;
+    #[cfg_attr(gnu_time64_abi, link_name = "pwritev64v2")]
     pub fn pwritev2(
@@ -1397,2 +1406,3 @@
     pub fn backtrace(buf: *mut *mut c_void, sz: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__glob64_time64")]
     pub fn glob64(
@@ -1403,2 +1413,3 @@
     ) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__globfree64_time64")]
     pub fn globfree64(pglob: *mut glob64_t);
@@ -1469,2 +1480,3 @@
     pub fn asctime_r(tm: *const crate::tm, buf: *mut c_char) -> *mut c_char;
+    #[cfg_attr(gnu_time64_abi, link_name = "__ctime64_r")]
     pub fn ctime_r(timep: *const time_t, buf: *mut c_char) -> *mut c_char;
--- a/src/unix/linux_like/linux/mod.rs
+++ b/src/unix/linux_like/linux/mod.rs
@@ -6007,7 +6007,12 @@
         extern "C" {
+            #[cfg_attr(gnu_time64_abi, link_name = "aio_read64")]
             pub fn aio_read(aiocbp: *mut aiocb) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "aio_write64")]
             pub fn aio_write(aiocbp: *mut aiocb) -> c_int;
             pub fn aio_fsync(op: c_int, aiocbp: *mut aiocb) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "aio_error64")]
             pub fn aio_error(aiocbp: *const aiocb) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "aio_return64")]
             pub fn aio_return(aiocbp: *mut aiocb) -> ssize_t;
+            #[cfg_attr(gnu_time64_abi, link_name = "__aio_suspend_time64")]
             pub fn aio_suspend(
@@ -6017,3 +6022,5 @@
             ) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "aio_cancel64")]
             pub fn aio_cancel(fd: c_int, aiocbp: *mut aiocb) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "lio_listio64")]
             pub fn lio_listio(
@@ -6031,2 +6038,3 @@
         extern "C" {
+            #[cfg_attr(gnu_time64_abi, link_name = "pwritev64")]
             pub fn pwritev(
@@ -6037,2 +6045,3 @@
             ) -> ssize_t;
+            #[cfg_attr(gnu_time64_abi, link_name = "preadv64")]
             pub fn preadv(
@@ -6072,2 +6081,3 @@
             ) -> isize;
+            #[cfg_attr(gnu_time64_abi, link_name = "__futimes64")]
             pub fn futimes(fd: c_int, times: *const crate::timeval) -> c_int;
@@ -6104,2 +6114,3 @@
             ) -> ssize_t;
+            #[cfg_attr(gnu_time64_abi, link_name = "__mq_timedreceive_time64")]
             pub fn mq_timedreceive(
@@ -6111,2 +6122,3 @@
             ) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "__mq_timedsend_time64")]
             pub fn mq_timedsend(
@@ -6161,2 +6173,3 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "__lutimes64")]
     pub fn lutimes(file: *const c_char, times: *const crate::timeval) -> c_int;
@@ -6182,2 +6195,3 @@
     pub fn shmdt(shmaddr: *const c_void) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__shmctl64")]
     pub fn shmctl(shmid: c_int, cmd: c_int, buf: *mut crate::shmid_ds) -> c_int;
@@ -6186,3 +6200,5 @@
     pub fn semop(semid: c_int, sops: *mut crate::sembuf, nsops: size_t) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__semctl64")]
     pub fn semctl(semid: c_int, semnum: c_int, cmd: c_int, ...) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__msgctl64")]
     pub fn msgctl(msqid: c_int, cmd: c_int, buf: *mut msqid_ds) -> c_int;
@@ -6201,3 +6217,5 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "fallocate64")]
     pub fn fallocate(fd: c_int, mode: c_int, offset: off_t, len: off_t) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "posix_fallocate64")]
     pub fn posix_fallocate(fd: c_int, offset: off_t, len: off_t) -> c_int;
@@ -6251,3 +6269,5 @@
     pub fn timerfd_create(clockid: crate::clockid_t, flags: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__timerfd_gettime64")]
     pub fn timerfd_gettime(fd: c_int, curr_value: *mut itimerspec) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__timerfd_settime64")]
     pub fn timerfd_settime(
@@ -6308,2 +6328,3 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "__glob64_time64")]
     pub fn glob(
@@ -6314,2 +6335,3 @@
     ) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__globfree64_time64")]
     pub fn globfree(pglob: *mut crate::glob_t);
@@ -6339,2 +6361,3 @@
     ) -> ssize_t;
+    #[cfg_attr(gnu_time64_abi, link_name = "mkstemps64")]
     pub fn mkstemps(template: *mut c_char, suffixlen: c_int) -> c_int;
@@ -6375,2 +6398,3 @@
     pub fn tee(fd_in: c_int, fd_out: c_int, len: size_t, flags: c_uint) -> ssize_t;
+    #[cfg_attr(gnu_time64_abi, link_name = "__settimeofday64")]
     pub fn settimeofday(tv: *const crate::timeval, tz: *const crate::timezone) -> c_int;
@@ -6390,3 +6414,5 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "__sched_rr_get_interval64")]
     pub fn sched_rr_get_interval(pid: crate::pid_t, tp: *mut crate::timespec) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__sem_timedwait64")]
     pub fn sem_timedwait(sem: *mut sem_t, abstime: *const crate::timespec) -> c_int;
@@ -6406,4 +6432,6 @@
     pub fn personality(persona: c_ulong) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__prctl_time64")]
     pub fn prctl(option: c_int, ...) -> c_int;
     pub fn sched_getparam(pid: crate::pid_t, param: *mut crate::sched_param) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__ppoll64")]
     pub fn ppoll(
@@ -6420,2 +6448,3 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "__pthread_mutex_timedlock64")]
     pub fn pthread_mutex_timedlock(
@@ -6454,2 +6483,10 @@
     pub fn sched_getscheduler(pid: crate::pid_t) -> c_int;
+    #[cfg_attr(
+        all(
+            target_env = "gnu",
+            target_pointer_width = "32",
+            not(target_arch = "x86_64")
+        ),
+        link_name = "__clock_nanosleep_time64"
+    )]
     pub fn clock_nanosleep(
@@ -6505,2 +6542,3 @@
     ) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "sendfile64")]
     pub fn sendfile(out_fd: c_int, in_fd: c_int, offset: *mut off_t, count: size_t) -> ssize_t;
@@ -6710,3 +6748,5 @@
     pub fn timer_getoverrun(timerid: crate::timer_t) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__timer_gettime64")]
     pub fn timer_gettime(timerid: crate::timer_t, curr_value: *mut crate::itimerspec) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__timer_settime64")]
     pub fn timer_settime(
@@ -6752,2 +6792,3 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "__ioctl_time64")]
     pub fn ioctl(fd: c_int, request: Ioctl, ...) -> c_int;
--- a/src/unix/linux_like/mod.rs
+++ b/src/unix/linux_like/mod.rs
@@ -1751,4 +1751,7 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "__clock_getres64")]
     pub fn clock_getres(clk_id: crate::clockid_t, tp: *mut crate::timespec) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__clock_gettime64")]
     pub fn clock_gettime(clk_id: crate::clockid_t, tp: *mut crate::timespec) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__clock_settime64")]
     pub fn clock_settime(clk_id: crate::clockid_t, tp: *const crate::timespec) -> c_int;
@@ -1767,7 +1770,12 @@
     pub fn pipe2(fds: *mut c_int, flags: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "statfs64")]
     pub fn statfs(path: *const c_char, buf: *mut statfs) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "fstatfs64")]
     pub fn fstatfs(fd: c_int, buf: *mut statfs) -> c_int;
     pub fn memrchr(cx: *const c_void, c: c_int, n: size_t) -> *mut c_void;
+    #[cfg_attr(gnu_time64_abi, link_name = "posix_fadvise64")]
     pub fn posix_fadvise(fd: c_int, offset: off_t, len: off_t, advise: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__futimens64")]
     pub fn futimens(fd: c_int, times: *const crate::timespec) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__utimensat64")]
     pub fn utimensat(
@@ -1822,2 +1830,3 @@
     pub fn setresuid(ruid: crate::uid_t, euid: crate::uid_t, suid: crate::uid_t) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__wait4_time64")]
     pub fn wait4(
@@ -1854,3 +1863,5 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "__sendmsg64")]
     pub fn sendmsg(fd: c_int, msg: *const crate::msghdr, flags: c_int) -> ssize_t;
+    #[cfg_attr(gnu_time64_abi, link_name = "__recvmsg64")]
     pub fn recvmsg(fd: c_int, msg: *mut crate::msghdr, flags: c_int) -> ssize_t;
@@ -1875,3 +1886,5 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "mkostemp64")]
     pub fn mkostemp(template: *mut c_char, flags: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "mkostemps64")]
     pub fn mkostemps(template: *mut c_char, suffixlen: c_int, flags: c_int) -> c_int;
--- a/src/unix/linux_like/linux/mod.rs
+++ b/src/unix/linux_like/linux/mod.rs
@@ -1875,2 +1886,3 @@
     pub fn dup3(oldfd: c_int, newfd: c_int, flags: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "__sigtimedwait64")]
     pub fn sigtimedwait(
--- a/src/unix/linux_like/mod.rs
+++ b/src/unix/linux_like/mod.rs
@@ -1891,3 +1905,5 @@
             pub fn creat64(path: *const c_char, mode: mode_t) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "__fstat64_time64")]
             pub fn fstat64(fildes: c_int, buf: *mut stat64) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "__fstatat64_time64")]
             pub fn fstatat64(
@@ -1900,2 +1916,3 @@
             pub fn lseek64(fd: c_int, offset: off64_t, whence: c_int) -> off64_t;
+            #[cfg_attr(gnu_time64_abi, link_name = "__lstat64_time64")]
             pub fn lstat64(path: *const c_char, buf: *mut stat64) -> c_int;
@@ -1930,2 +1947,3 @@
             ) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "__stat64_time64")]
             pub fn stat64(path: *const c_char, buf: *mut stat64) -> c_int;
--- a/src/unix/mod.rs
+++ b/src/unix/mod.rs
@@ -574,2 +574,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "fopen64")]
     pub fn fopen(filename: *const c_char, mode: *const c_char) -> *mut FILE;
@@ -579,2 +580,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "freopen64")]
     pub fn freopen(filename: *const c_char, mode: *const c_char, file: *mut FILE) -> *mut FILE;
@@ -585,2 +587,3 @@
     pub fn rename(oldname: *const c_char, newname: *const c_char) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "tmpfile64")]
     pub fn tmpfile() -> *mut FILE;
@@ -610,4 +613,6 @@
     #[cfg_attr(target_os = "netbsd", link_name = "__fgetpos50")]
+    #[cfg_attr(gnu_time64_abi, link_name = "fgetpos64")]
     pub fn fgetpos(stream: *mut FILE, ptr: *mut fpos_t) -> c_int;
     #[cfg_attr(target_os = "netbsd", link_name = "__fsetpos50")]
+    #[cfg_attr(gnu_time64_abi, link_name = "fsetpos64")]
     pub fn fsetpos(stream: *mut FILE, ptr: *const fpos_t) -> c_int;
@@ -761,2 +766,3 @@
     #[cfg_attr(target_os = "espidf", link_name = "lwip_setsockopt")]
+    #[cfg_attr(gnu_time64_abi, link_name = "__setsockopt64")]
     pub fn setsockopt(
@@ -823,2 +829,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "__fstat64_time64")]
     pub fn fstat(fildes: c_int, buf: *mut stat) -> c_int;
@@ -836,2 +843,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "__stat64_time64")]
     pub fn stat(path: *const c_char, buf: *mut stat) -> c_int;
@@ -850,2 +858,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "open64")]
     pub fn open(path: *const c_char, oflag: c_int, ...) -> c_int;
@@ -855,2 +864,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "creat64")]
     pub fn creat(path: *const c_char, mode: mode_t) -> c_int;
@@ -860,2 +870,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "__fcntl_time64")]
     pub fn fcntl(fd: c_int, cmd: c_int, ...) -> c_int;
@@ -882,2 +893,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "readdir64")]
     pub fn readdir(dirp: *mut crate::DIR) -> *mut crate::dirent;
@@ -920,2 +932,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "__fstatat64_time64")]
     pub fn fstatat(dirfd: c_int, pathname: *const c_char, buf: *mut stat, flags: c_int) -> c_int;
@@ -994,2 +1007,3 @@
     pub fn link(src: *const c_char, dst: *const c_char) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "lseek64")]
     pub fn lseek(fd: c_int, offset: off_t, whence: c_int) -> off_t;
@@ -1023,2 +1037,3 @@
     #[cfg_attr(target_os = "netbsd", link_name = "__nanosleep50")]
+    #[cfg_attr(gnu_time64_abi, link_name = "__nanosleep64")]
     pub fn nanosleep(rqtp: *const timespec, rmtp: *mut timespec) -> c_int;
@@ -1053,2 +1068,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "pread64")]
     pub fn pread(fd: c_int, buf: *mut c_void, count: size_t, offset: off_t) -> ssize_t;
@@ -1058,2 +1074,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "pwrite64")]
     pub fn pwrite(fd: c_int, buf: *const c_void, count: size_t, offset: off_t) -> ssize_t;
@@ -1065,2 +1082,3 @@
     #[cfg_attr(target_os = "netbsd", link_name = "__utime50")]
+    #[cfg_attr(gnu_time64_abi, link_name = "__utime64")]
     pub fn utime(file: *const c_char, buf: *const utimbuf) -> c_int;
@@ -1087,2 +1105,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "mmap64")]
     pub fn mmap(
@@ -1113,2 +1132,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "__lstat64_time64")]
     pub fn lstat(path: *const c_char, buf: *mut stat) -> c_int;
@@ -1135,3 +1155,5 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "truncate64")]
     pub fn truncate(path: *const c_char, length: off_t) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "ftruncate64")]
     pub fn ftruncate(fd: c_int, length: off_t) -> c_int;
@@ -1141,2 +1163,3 @@
     #[cfg_attr(target_os = "netbsd", link_name = "__getrusage50")]
+    #[cfg_attr(gnu_time64_abi, link_name = "__getrusage64")]
     pub fn getrusage(resource: c_int, usage: *mut rusage) -> c_int;
@@ -1216,2 +1239,3 @@
     )]
+    #[cfg_attr(gnu_time64_abi, link_name = "__pthread_cond_timedwait64")]
     pub fn pthread_cond_timedwait(
@@ -1272,2 +1296,3 @@
     #[cfg_attr(target_os = "espidf", link_name = "lwip_getsockopt")]
+    #[cfg_attr(gnu_time64_abi, link_name = "__getsockopt64")]
     pub fn getsockopt(
@@ -1282,2 +1307,3 @@
     #[cfg_attr(target_os = "netbsd", link_name = "__utimes50")]
+    #[cfg_attr(gnu_time64_abi, link_name = "__utimes64")]
     pub fn utimes(filename: *const c_char, times: *const crate::timeval) -> c_int;
@@ -1332,2 +1358,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__gmtime64_r")]
     pub fn gmtime_r(time_p: *const time_t, result: *mut tm) -> *mut tm;
@@ -1336,2 +1363,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__localtime64_r")]
     pub fn localtime_r(time_p: *const time_t, result: *mut tm) -> *mut tm;
@@ -1344,2 +1372,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__mktime64")]
     pub fn mktime(tm: *mut tm) -> time_t;
@@ -1348,2 +1377,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__time64")]
     pub fn time(time: *mut time_t) -> time_t;
@@ -1352,2 +1382,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__gmtime64")]
     pub fn gmtime(time_p: *const time_t) -> *mut tm;
@@ -1356,2 +1387,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__localtime64")]
     pub fn localtime(time_p: *const time_t) -> *mut tm;
@@ -1360,2 +1392,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__difftime64")]
     pub fn difftime(time1: time_t, time0: time_t) -> c_double;
@@ -1364,2 +1397,3 @@
     // FIXME: for `time_t`
+    #[cfg_attr(gnu_time64_abi, link_name = "__timegm64")]
     pub fn timegm(tm: *mut crate::tm) -> time_t;
@@ -1418,2 +1452,3 @@
     #[cfg_attr(target_os = "netbsd", link_name = "__select50")]
+    #[cfg_attr(gnu_time64_abi, link_name = "__select64")]
     pub fn select(
@@ -1436,3 +1471,5 @@
     pub fn sem_post(sem: *mut sem_t) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "statvfs64")]
     pub fn statvfs(path: *const c_char, buf: *mut statvfs) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "fstatvfs64")]
     pub fn fstatvfs(fd: c_int, buf: *mut statvfs) -> c_int;
@@ -1460,3 +1497,5 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "fseeko64")]
     pub fn fseeko(stream: *mut crate::FILE, offset: off_t, whence: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "ftello64")]
     pub fn ftello(stream: *mut crate::FILE) -> off_t;
@@ -1477,2 +1516,3 @@
     pub fn tcsendbreak(fd: c_int, duration: c_int) -> c_int;
+    #[cfg_attr(gnu_time64_abi, link_name = "mkstemp64")]
     pub fn mkstemp(template: *mut c_char) -> c_int;
@@ -1501,2 +1541,3 @@
 
+    #[cfg_attr(gnu_time64_abi, link_name = "lockf64")]
     pub fn lockf(fd: c_int, cmd: c_int, len: off_t) -> c_int;
@@ -1531,2 +1572,3 @@
         extern "C" {
+            #[cfg_attr(gnu_time64_abi, link_name = "__adjtime64")]
             pub fn adjtime(delta: *const timeval, olddelta: *mut timeval) -> c_int;
@@ -1575,2 +1617,3 @@
             pub fn mkdirat(dirfd: c_int, pathname: *const c_char, mode: crate::mode_t) -> c_int;
+            #[cfg_attr(gnu_time64_abi, link_name = "openat64")]
             pub fn openat(dirfd: c_int, pathname: *const c_char, flags: c_int, ...) -> c_int;
@@ -1598,2 +1641,3 @@
             /// https://www.unix.com/man-page/opensolaris/3LIB/libc/
+            #[cfg_attr(gnu_time64_abi, link_name = "readdir64_r")]
             pub fn readdir_r(
@@ -1682,2 +1726,3 @@
             #[cfg_attr(target_os = "netbsd", link_name = "__pselect50")]
+            #[cfg_attr(gnu_time64_abi, link_name = "__pselect64")]
             pub fn pselect(
