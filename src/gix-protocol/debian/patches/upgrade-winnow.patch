From 3cd3e2a71beb01591afe732ab4ae914ed62a4ecf Mon Sep 17 00:00:00 2001
From: Ed Page <eopage@gmail.com>
Date: Fri, 31 Jan 2025 10:08:32 -0600
Subject: [PATCH] Resolve Winnow deprecations

---
 gix-actor/src/signature/decode.rs             | 42 +++++++++----------
 gix-config/src/parse/nom/mod.rs               | 40 +++++++++---------
 gix-config/src/parse/nom/tests.rs             | 17 ++++++--
 gix-object/src/commit/decode.rs               | 20 ++++-----
 gix-object/src/commit/message/body.rs         | 10 ++---
 gix-object/src/commit/message/decode.rs       |  8 ++--
 gix-object/src/parse.rs                       | 10 ++---
 gix-object/src/tag/decode.rs                  |  8 ++--
 gix-object/src/tag/ref_iter.rs                |  3 +-
 gix-object/src/tree/ref_iter.rs               |  9 ++--
 src/remote_progress.rs           |  8 ++--
 gix-ref/src/parse.rs                          |  4 +-
 gix-ref/src/store/file/log/line.rs            |  8 ++--
 .../src/store/file/loose/reference/decode.rs  |  2 +-
 gix-ref/src/store/packed/decode.rs            |  6 +--
 gix-ref/src/store/packed/iter.rs              |  6 +--
 16 files changed, 100 insertions(+), 101 deletions(-)

--- a/src/remote_progress.rs
+++ b/src/remote_progress.rs
@@ -71,13 +71,13 @@
     }
 }
 
-fn parse_number(i: &mut &[u8]) -> PResult<usize, ()> {
+fn parse_number(i: &mut &[u8]) -> ModalResult<usize, ()> {
     take_till(0.., |c: u8| !c.is_ascii_digit())
         .try_map(gix_utils::btoi::to_signed)
         .parse_next(i)
 }
 
-fn next_optional_percentage(i: &mut &[u8]) -> PResult<Option<u32>, ()> {
+fn next_optional_percentage(i: &mut &[u8]) -> ModalResult<Option<u32>, ()> {
     opt(terminated(
         preceded(
             take_till(0.., |c: u8| c.is_ascii_digit()),
@@ -88,11 +88,11 @@
     .parse_next(i)
 }
 
-fn next_optional_number(i: &mut &[u8]) -> PResult<Option<usize>, ()> {
+fn next_optional_number(i: &mut &[u8]) -> ModalResult<Option<usize>, ()> {
     opt(preceded(take_till(0.., |c: u8| c.is_ascii_digit()), parse_number)).parse_next(i)
 }
 
-fn parse_progress<'i>(line: &mut &'i [u8]) -> PResult<RemoteProgress<'i>, ()> {
+fn parse_progress<'i>(line: &mut &'i [u8]) -> ModalResult<RemoteProgress<'i>, ()> {
     let action = take_till(1.., |c| c == b':').parse_next(line)?;
     let percent = next_optional_percentage.parse_next(line)?;
     let step = next_optional_number.parse_next(line)?;
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -130,7 +130,7 @@
 version = "2.0.0"
 
 [dependencies.winnow]
-version = "0.6"
+version = "0.7"
 features = ["simd"]
 
 [dev-dependencies.async-std]
