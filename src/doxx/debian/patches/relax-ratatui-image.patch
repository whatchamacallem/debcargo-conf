Description: Update ratatui-image dependency
Author: Nadzeya Hutsko <nadzya.info@gmail.com>
Forwarded: https://github.com/bgreenwell/doxx/issues/59
Last-Update: 2025-10-14
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -103,7 +103,7 @@
 version = "0.28"
 
 [dependencies.ratatui-image]
-version = "1.0"
+version = "8"
 
 [dependencies.regex]
 version = "1.10"
--- a/src/ui.rs
+++ b/src/ui.rs
@@ -24,7 +24,7 @@
 use crate::{document::*, Cli};
 use ratatui_image::{picker::Picker, protocol::StatefulProtocol};
 
-type ImageProtocols = Vec<Box<dyn StatefulProtocol>>;
+type ImageProtocols = Vec<StatefulProtocol>;
 
 pub struct App {
     pub document: Document,
@@ -95,19 +95,17 @@
     }
 
     fn init_image_support(&mut self) {
-        // Try to initialize picker from termios on Unix, use default on Windows
+        // Try to initialize picker from query_stdio on Unix, use default on Windows
         #[cfg(unix)]
-        let mut picker = if let Ok(p) = Picker::from_termios() {
+        let picker = if let Ok(p) = Picker::from_query_stdio() {
             p
         } else {
             // Fallback to manual font size
-            Picker::new((8, 16))
+            Picker::from_fontsize((8, 16))
         };
 
         #[cfg(not(unix))]
-        let mut picker = Picker::new((8, 16));
-
-        picker.guess_protocol();
+        let picker = Picker::from_fontsize((8, 16));
 
         // Process all images in the document
         for element in &self.document.elements {
