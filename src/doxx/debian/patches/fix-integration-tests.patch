Description: Fix integration tests to work outside development environment
 The integration tests currently invoke the binary using Command::new("cargo")
 which requires a full source tree and cargo to be available at test time.
 This causes tests to fail when the package is installed system-wide without
 the source tree present.
 .
 This patch changes the tests to use env!("CARGO_BIN_EXE_doxx"), which is
 the documented Cargo pattern for integration tests that need to invoke the
 compiled binary.
Author: Nadzeya Hutsko <nadzya.info@gmail.com>
Forwarded: https://github.com/bgreenwell/doxx/issues/60
Last-Update: 2025-10-14
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/tests/integration_test.rs
+++ b/tests/integration_test.rs
@@ -3,8 +3,8 @@
 
 #[test]
 fn test_minimal_document_parsing() {
-    let output = Command::new("cargo")
-        .args(["run", "--bin", "doxx", "tests/fixtures/minimal.docx"])
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
+        .args(["tests/fixtures/minimal.docx"])
         .output()
         .expect("Failed to execute doxx");
 
@@ -21,11 +21,8 @@
 
 #[test]
 fn test_tables_csv_export() {
-    let output = Command::new("cargo")
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
         .args([
-            "run",
-            "--bin",
-            "doxx",
             "tests/fixtures/tables-heavy.docx",
             "--export",
             "csv",
@@ -46,11 +43,8 @@
 
 #[test]
 fn test_headings_outline() {
-    let output = Command::new("cargo")
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
         .args([
-            "run",
-            "--bin",
-            "doxx",
             "tests/fixtures/headings-hierarchy.docx",
             "--outline",
         ])
@@ -67,11 +61,8 @@
 
 #[test]
 fn test_formatting_markdown_export() {
-    let output = Command::new("cargo")
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
         .args([
-            "run",
-            "--bin",
-            "doxx",
             "tests/fixtures/formatting-showcase.docx",
             "--export",
             "markdown",
@@ -92,11 +83,8 @@
 
 #[test]
 fn test_unicode_document() {
-    let output = Command::new("cargo")
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
         .args([
-            "run",
-            "--bin",
-            "doxx",
             "tests/fixtures/unicode-special.docx",
         ])
         .output()
@@ -112,11 +100,8 @@
 
 #[test]
 fn test_business_report_parsing() {
-    let output = Command::new("cargo")
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
         .args([
-            "run",
-            "--bin",
-            "doxx",
             "tests/fixtures/business-report.docx",
         ])
         .output()
@@ -135,11 +120,8 @@
 
 #[test]
 fn test_export_test_json() {
-    let output = Command::new("cargo")
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
         .args([
-            "run",
-            "--bin",
-            "doxx",
             "tests/fixtures/export-test.docx",
             "--export",
             "json",
@@ -157,11 +139,8 @@
 
 #[test]
 fn test_search_functionality() {
-    let output = Command::new("cargo")
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
         .args([
-            "run",
-            "--bin",
-            "doxx",
             "tests/fixtures/business-report.docx",
             "--search",
             "revenue",
@@ -182,8 +161,8 @@
 
 #[test]
 fn test_help_command() {
-    let output = Command::new("cargo")
-        .args(["run", "--bin", "doxx", "--", "--help"])
+    let output = Command::new(env!("CARGO_BIN_EXE_doxx"))
+        .args(["--help"])
         .output()
         .expect("Failed to execute doxx");
 
