#!/usr/bin/make -f
%:
	dh $@ --buildsystem cargo

# regenerating the source code and apply patch(es)
execute_before_dh_auto_build:
	cp /usr/share/gir-1.0/GObject-2.0.gir $(CURDIR)
	cp /usr/share/gir-1.0/GLib-2.0.gir $(CURDIR)
	sed -i 's/girs_directories\s=\s\[\"\.\.\/\.\.\/gir-files\"\]/girs_directories = \[\".\"\]/' $(CURDIR)/Gir.toml
	gir -o .
	patch -p1 < $(CURDIR)/debian/patches/fix-test-failure.diff

# remove the .gir files before install
execute_before_dh_auto_install:
	rm $(CURDIR)/*.gir

