diff --git a/Cargo.toml b/Cargo.toml
index ac8cdc6..78112d0 100644
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -42,6 +42,8 @@ unstable = []
 name = "cargo_metadata"
 path = "src/lib.rs"
 
+[dev-dependencies.tempfile]
+version = "3"
 [[test]]
 name = "selftest"
 path = "tests/selftest.rs"
diff --git a/Cargo.toml.orig b/Cargo.toml.orig
index 5f620bc..ac8cdc6 100644
--- a/Cargo.toml.orig
+++ b/Cargo.toml.orig
@@ -1,27 +1,30 @@
+# THIS FILE IS AUTOMATICALLY GENERATED BY CARGO
+#
+# When uploading crates to the registry Cargo will automatically
+# "normalize" Cargo.toml files for maximal compatibility
+# with all versions of Cargo and also rewrite `path` dependencies
+# to registry (e.g., crates.io) dependencies.
+#
+# If you are reading this file be aware that the original Cargo.toml
+# will likely look very different (and much more reasonable).
+# See Cargo.toml.orig for the original contents.
+
 [package]
+edition = "2021"
+rust-version = "1.86.0"
 name = "cargo_metadata"
 version = "0.23.0"
 authors = ["Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de>"]
-repository = "https://github.com/oli-obk/cargo_metadata"
+build = false
+autolib = false
+autobins = false
+autoexamples = false
+autotests = false
+autobenches = false
 description = "structured access to the output of `cargo metadata`"
-license = "MIT"
 readme = "README.md"
-edition = "2021"
-rust-version = "1.86.0"
-
-[dependencies]
-camino = { version = "1.1.10", features = ["serde1"] }
-cargo-platform = "0.3.0"
-derive_builder = { version = "0.20", optional = true }
-semver = { version = "1.0.26", features = ["serde"] }
-serde = { version = "1.0.219", features = ["derive"] }
-serde_json = { version = "1.0.142", features = ["unbounded_depth"] }
-thiserror = "2.0.12"
-
-[features]
-default = []
-builder = ["derive_builder"]
-unstable = []
+license = "MIT"
+repository = "https://github.com/oli-obk/cargo_metadata"
 
 [package.metadata.docs.rs]
 all-features = true
@@ -29,3 +32,46 @@ all-features = true
 [package.metadata.cargo_metadata_test]
 some_field = true
 other_field = "foo"
+
+[features]
+builder = ["derive_builder"]
+default = []
+unstable = []
+
+[lib]
+name = "cargo_metadata"
+path = "src/lib.rs"
+
+[[test]]
+name = "selftest"
+path = "tests/selftest.rs"
+
+[[test]]
+name = "test_samples"
+path = "tests/test_samples.rs"
+
+[dependencies.camino]
+version = "1.1.10"
+features = ["serde1"]
+
+[dependencies.cargo-platform]
+version = "0.3.0"
+
+[dependencies.derive_builder]
+version = "0.20"
+optional = true
+
+[dependencies.semver]
+version = "1.0.26"
+features = ["serde"]
+
+[dependencies.serde]
+version = "1.0.219"
+features = ["derive"]
+
+[dependencies.serde_json]
+version = "1.0.142"
+features = ["unbounded_depth"]
+
+[dependencies.thiserror]
+version = "2.0.12"
diff --git a/tests/selftest.rs b/tests/selftest.rs
index 5377e56..e1658bd 100644
--- a/tests/selftest.rs
+++ b/tests/selftest.rs
@@ -53,31 +53,35 @@ fn metadata() {
 
 #[test]
 fn builder_interface() {
+    let dir = tempfile::tempdir().unwrap();
+    let path = dir.path().join("Cargo.toml");
+    let path_str = path.to_str().unwrap().to_string();
+    std::fs::copy("Cargo.toml", &path).unwrap();
     let _ = MetadataCommand::new()
-        .manifest_path("Cargo.toml")
+        .manifest_path(path_str.as_str())
         .exec()
         .unwrap();
     let _ = MetadataCommand::new()
-        .manifest_path(String::from("Cargo.toml"))
+        .manifest_path(path_str.clone())
         .exec()
         .unwrap();
     let _ = MetadataCommand::new()
-        .manifest_path(PathBuf::from("Cargo.toml"))
+        .manifest_path(path.clone())
         .exec()
         .unwrap();
     let _ = MetadataCommand::new()
-        .manifest_path("Cargo.toml")
+        .manifest_path(&path_str)
         .no_deps()
         .exec()
         .unwrap();
     let _ = MetadataCommand::new()
-        .manifest_path("Cargo.toml")
+        .manifest_path(&path_str)
         .features(CargoOpt::AllFeatures)
         .exec()
         .unwrap();
     let _ = MetadataCommand::new()
-        .manifest_path("Cargo.toml")
-        .current_dir(current_dir().unwrap())
+        .manifest_path(&path_str)
+        .current_dir(dir.path())
         .exec()
         .unwrap();
 }
@@ -87,7 +91,7 @@ fn error1() {
     let manifest_path = current_dir().unwrap().join("foo");
     let error = "error: the manifest-path must be a path to a Cargo.toml file";
     let error_with_path = format!("{error}: `{}`", manifest_path.display());
-    match MetadataCommand::new().manifest_path("foo").exec() {
+    match MetadataCommand::new().other_options(["--color=never".to_string()].to_vec()).manifest_path("foo").exec() {
         Err(Error::CargoMetadata { stderr }) => {
             assert!([error, &error_with_path].contains(&stderr.trim()))
         }
@@ -97,7 +101,7 @@ fn error1() {
 
 #[test]
 fn error2() {
-    match MetadataCommand::new()
+    match MetadataCommand::new().other_options(["--color=never".to_string()].to_vec())
         .manifest_path("foo/Cargo.toml")
         .exec()
     {
